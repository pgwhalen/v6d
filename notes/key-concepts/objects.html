<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta property="og:title" content="Objects" />
<meta property="og:type" content="website" />
<meta property="og:url" content="notes/key-concepts/objects.html" />
<meta property="og:site_name" content="vineyard" />
<meta property="og:description" content="Vineyard represents various data types as vineyard objects. It employs a metadata-payloads decoupled design, where an object in vineyard comprises: A collection of blobs containing the actual data ..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="/_images/social_previews/summary_notes_key-concepts_objects_2df5ca9c.png" />
<meta property="og:image:alt" content="Vineyard represents various data types as vineyard objects. It employs a metadata-payloads decoupled design, where an object in vineyard comprises: A collect..." />
<meta name="description" content="Vineyard represents various data types as vineyard objects. It employs a metadata-payloads decoupled design, where an object in vineyard comprises: A collection of blobs containing the actual data ..." />
<meta name="twitter:card" content="summary_large_image" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Code Generation for Boilerplate" href="vcdl.html" /><link rel="prev" title="Key Concepts" href="../key-concepts.html" />

    <link rel="shortcut icon" href="../../_static/vineyard.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Objects - Vineyard</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/brands.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/v4-shims.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/panels.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
<script>
  document.body.dataset.theme = "light";
</script>

<script>
  function ready(callback) {
    if (document.readyState!='loading') {
      // in case the document is already rendered
      callback();
    } else if (document.addEventListener) {
      // modern browsers
      document.addEventListener('DOMContentLoaded', callback);
    } else document.attachEvent('onreadystatechange', function() {
      // IE <= 8
      if (document.readyState=='complete') {
        callback();
      }
    });
  }

  ready(function() {
    let coll = document.getElementsByClassName("admonition-details");
    for (let i = 0; i < coll.length; i++) {
      let titles = coll[i].getElementsByClassName("admonition-title");
      if (titles.length == 0) {
        continue;
      }
      titles[0].addEventListener("click", function () {
        this.parentElement.classList.toggle("active");

        if (this.parentElement.classList.contains("active")) {
          this.getElementsByClassName("admonition-caret")[0].innerText = " - (click to collapse)";
        } else {
          this.getElementsByClassName("admonition-caret")[0].innerText = " + (click to expand)";
        }
      });
      titles[0].appendChild(document.createElement("br"));
      let caret = document.createElement("span");
      caret.classList.add("admonition-caret");
      caret.innerText = " + (click to expand)";
      titles[0].appendChild(caret);
    }
  });
</script>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Vineyard</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/vineyard-logo-h.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../key-concepts.html">Key Concepts</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal">Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="vcdl.html">Code Generation for Boilerplate</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-accessing.html">Data Accessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="streams.html">Streams in Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="io-drivers.html">I/O Drivers</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Cloud-Native</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cloud-native/deploy-kubernetes.html">Deploy on Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud-native/vineyard-operator.html">Vineyard Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud-native/vineyardctl.html">Command-line tool</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/data-processing.html">Data processing</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/data-processing/using-objects-python.html">Sharing Python Objects with Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/data-processing/python-sharedmemory.html"><code class="code docutils literal notranslate"><span class="pre">multiprocessing.shared_memory</span></code> in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/data-processing/distributed-learning.html">Distributed Learning with Vineyard</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/kubernetes.html">Vineyard on Kubernetes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/kubernetes/using-vineyard-operator.html">Use vineyard operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/kubernetes/ml-pipeline-mars-pytorch.html">Machine learning with Vineyard on Kubernetes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/extending.html">Extending vineyard</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/extending/define-datatypes-python.html">Define Data Types in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/extending/define-datatypes-cpp.html">Defining Custom Data Types in C++</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Integration</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../integration-bigdata.html">Big-data on Vineyard</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../integration/dask.html">Dask on Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration/ml.html">Machine Learning with Vineyard</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../integration-orchestration.html">Workflow orchestration</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../integration/airflow.html">Airflow on Vineyard</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../references.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../references/python-api.html">Python API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references/cpp-api.html">C++ API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references/ctl.html">Vineyard Cli</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guides</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developers.html">Getting Involved</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../developers/build-from-source.html">Building from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developers/contributing.html">Contributing to vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developers/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developers/roadmap.html">Roadmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developers/faq.html">Frequently Asked Questions</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/v6d-io/v6d/edit/main/docs/notes/key-concepts/objects.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="objects">
<span id="vineyard-objects"></span><h1>Objects<a class="headerlink" href="#objects" title="Permalink to this heading">#</a></h1>
<p>Vineyard represents various data types as vineyard objects. It employs a
metadata-payloads decoupled design, where an object in vineyard comprises:</p>
<ol class="arabic simple">
<li><p>A collection of blobs containing the actual data payload;</p></li>
<li><p>A hierarchical meta tree that describes the data’s type, layout, and properties.</p></li>
</ol>
<div class="section" id="object-metadata-payloads">
<span id="metadata-and-payloads"></span><h2>Object = metadata + payloads<a class="headerlink" href="#object-metadata-payloads" title="Permalink to this heading">#</a></h2>
<p>There are some examples that explain the basic idea of metadata and payload that
forms vineyard objects:</p>
<ul class="simple">
<li><p>Blob: A blob is a pointer with a length that describes the size of the data,</p>
<ul>
<li><p>metadata:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">length</span></code></p></li>
</ul>
</li>
<li><p>payloads:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">pointer</span></code>, the actual payload of the blob</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Tensor: A tensor can be viewed as a blob that contains the actual data and several
metadata entries that describe the shape and type information,</p>
<ul>
<li><p>metadata:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">shape</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">dtype</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">data</span></code>, a member with type <code class="code docutils literal notranslate"><span class="pre">Blob</span></code></p></li>
</ul>
</li>
<li><p>payloads:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">pointer</span></code> in the member <code class="code docutils literal notranslate"><span class="pre">data</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>Dataframe: A dataframe is an ordered collection of tensors as its columns and each
column has a unique name,</p>
<ul>
<li><p>metadata:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">column_size</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">names</span></code>, a list of members with type <code class="code docutils literal notranslate"><span class="pre">string</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">columns</span></code>, a list of member with type <code class="code docutils literal notranslate"><span class="pre">Tensor</span></code></p></li>
</ul>
</li>
<li><p>payloads:</p>
<ul>
<li><p>a set of <code class="code docutils literal notranslate"><span class="pre">pointer</span></code> in the member <code class="code docutils literal notranslate"><span class="pre">columns</span></code> (the member <code class="code docutils literal notranslate"><span class="pre">data</span></code> of
of those <code class="code docutils literal notranslate"><span class="pre">Tensor</span></code> s)</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>From the example above, it is evident that objects naturally conform to a hierarchical
model, allowing complex data objects to be composed of simpler ones. Each object
consists of a set of blobs as the payload and a metadata tree that describes
the semantics and organization of those blobs.</p>
<div class="admonition-details admonition">
<p class="admonition-title">An example for the object metadata: a dataframe with two columns where each
             column is a tensor.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;__values_-key-0&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;__values_-key-1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;\&quot;a\&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;__values_-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;__values_-value-0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;buffer_&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;o800527ecdf05cff9&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;instance_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">39</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;nbytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;transient&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;typename&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vineyard::Blob&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;o000527ecdffd95c4&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;instance_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">39</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;nbytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;partition_index_&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;[]&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;shape_&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;[100]&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;signature&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1451273207424436</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;transient&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;typename&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vineyard::Tensor&lt;float&gt;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;value_type_&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;float&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;__values_-value-1&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;buffer_&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;o800527ecdeaf1015&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;instance_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">39</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;nbytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;transient&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;typename&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vineyard::Blob&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;o000527ece12e4f0a&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;instance_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">39</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;nbytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;partition_index_&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;[]&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;shape_&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;[100]&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;signature&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1451273227452968</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;transient&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;typename&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vineyard::Tensor&lt;double&gt;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;value_type_&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;double&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;columns_&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;[\&quot;a\&quot;,1]&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;o000527ece15d374c&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;instance_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">39</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;nbytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;partition_index_column_&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;partition_index_row_&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;row_batch_index_&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;signature&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1451273231074538</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;transient&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;typename&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vineyard::DataFrame&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>From the above example of object metadata, it is evident that an object is composed
of various sub-objects, forming a hierarchical data model. Each object consists of
a set of blobs and a metadata tree that describes the semantics of those blobs.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Without the metadata, the set of blobs would merely be a collection of memory
pieces without any meaningful interpretation.</p>
</div>
<p>Refer to <a class="reference internal" href="../../tutorials/data-processing/using-objects-python.html#using-objects-python"><span class="std std-ref">Sharing Python Objects with Vineyard</span></a> for a demonstration of how to put Python objects
into vineyard and retrieve them using IPC clients.</p>
</div>
<div class="section" id="separating-metadata-and-payload">
<h2>Separating metadata and payload<a class="headerlink" href="#separating-metadata-and-payload" title="Permalink to this heading">#</a></h2>
<p>The decoupling of data payload and data layout in vineyard offers three key advantages:</p>
<ol class="arabic simple">
<li><p>Payloads are stored locally within each vineyard instance, while metadata is shared
across all instances in the cluster. This significantly reduces the overhead of maintaining
consistency for distributed data.</p></li>
<li><p>Vineyard objects become self-descriptive, as the metadata fully determines how
the object should be resolved. This not only ensures semantic consistency when
sharing vineyard objects between different systems and programming languages,
but also allows users to store complex data structures with high-level abstractions, such
as graphs in CSR format directly in vineyard, without the need for serialization/deserialization
every time the object is saved or loaded.</p></li>
<li><p>This design enables the exploitation of data-aware scheduling techniques. For example, when processing
a graph in vineyard, we can easily access the metadata tree of the graph to determine the size of each
partitioned fragment without accessing the actual vertices and edges. As a result,
we can allocate precise amounts of computational resources for each fragment, leading to overall
performance improvements.</p></li>
</ol>
<p>Vineyard employs two design choices for the metadata and methods of its objects:</p>
<ol class="arabic simple">
<li><p>A composable design for vineyard objects, which facilitates distributed data management;</p></li>
<li><p>An extensible design for object methods, enabling flexible data sharing
between different computation systems with minimal additional development cost.</p></li>
</ol>
</div>
<div class="section" id="data-model">
<h2>Data model<a class="headerlink" href="#data-model" title="Permalink to this heading">#</a></h2>
<div class="section" id="composable">
<h3>Composable<a class="headerlink" href="#composable" title="Permalink to this heading">#</a></h3>
<p>The composition mechanism in vineyard is based on the hierarchical tree structure of
the metadata of its objects. The root metadata of a complex object stores references
to the root metadata of its components. By recursively traversing these references,
a complete metadata tree is constructed for the complex object.</p>
<div class="figure align-default" id="id2">
<a class="reference internal image-reference" href="../../_images/vineyard_composable.jpg"><img alt="Vineyard objects are composable" src="../../_images/vineyard_composable.jpg" style="width: 75%;" /></a>
<p class="caption"><span class="caption-text">Vineyard objects are composable</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</div>
<p>For instance, a distributed dataframe consists of partitioned dataframe chunks, while
a dataframe is composed of column vectors. Considering the decoupling design of payload
and layout in vineyard objects, the blobs are stored in the corresponding vineyard
instance’s memory for each partition, and the metadata (e.g., chunk index, shape,
column data types) are stored in the key-value store behind the metadata service.</p>
<p>To store a distributed graph, we first save the partitioned fragments in each vineyard
instance and share their metadata in the backend key-value store. Then, we can create
the distributed graph by generating the root metadata containing links to the root
metadata of the fragments in an efficient manner.</p>
</div>
<div class="section" id="distributed-objects">
<span id="id1"></span><h3>Distributed objects<a class="headerlink" href="#distributed-objects" title="Permalink to this heading">#</a></h3>
<p>Vineyard is designed to store large objects across multiple nodes in a cluster, enabling
user programs to seamlessly interact with these objects as a single entity. Data is
sharded across multiple machines without replication.</p>
<div class="figure align-default" id="id3">
<a class="reference internal image-reference" href="../../_images/vineyard_distributed_tensor.jpg"><img alt="Distributed objects in vineyard" src="../../_images/vineyard_distributed_tensor.jpg" style="width: 60%;" /></a>
<p class="caption"><span class="caption-text">Distributed objects in vineyard</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</div>
<p>For example, consider a “Tensor” object that contains billions of columns and rows, making
it too large to fit into a single machine. In such cases, the tensor can be split along
the index or column axis, with each vineyard node holding a subset of chunks. Vineyard
provides a logical view of the complete tensor, allowing distributed computation engines
like Mars and GraphScope to process the data structure as a whole.
.. TODO: add the collection APIs</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See also the concepts of <em>persistent objects</em> in the following subsection. Refer to
the following subsection for more information on the concept of <em>persistent objects</em>.</p>
</div>
</div>
<div class="section" id="transient-vs-persistent">
<h3>Transient vs. Persistent<a class="headerlink" href="#transient-vs-persistent" title="Permalink to this heading">#</a></h3>
<p>As previously mentioned, vineyard objects’ metadata and payloads are managed separately
by different components of the vineyard server. Payloads are designed to be shared with
computing engines using local memory mapping. However, metadata may need to be inspected
by clients connected to other vineyard instances, such as when forming a distributed object.
In this case, the distributed object consists of a set of chunks placed on different
vineyard instances. When retrieving the distributed objects from vineyard, computing engines
may need to inspect the metadata of non-local pieces to understand the distribution of the
entire dataset.</p>
<p>This requirement implies that metadata must be globally synchronized and accessible from
clients connected to other vineyard instances. However, global synchronization is a costly
operation, and numerous small key-value pairs can significantly increase the burden on the
key-value store backend of our metadata services. To address this issue, we categorize
objects as transient or persistent.</p>
<ul class="simple">
<li><p><strong>Transient objects</strong> are designed for cases where the object is known not to be part of a
distributed object and will never need to be inspected by clients on other vineyard instances.
Transient objects are useful for short-lived immediate values within the progress of a
single computing engine.</p></li>
<li><p><strong>Persistent objects</strong> are designed for cases where the object chunk will be used to form
a larger distributed object, and the metadata is needed when applications inspect the
distributed object. Persistent objects and distributed objects are commonly used to pass
intermediate data between two distributed engines.</p></li>
</ul>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>By default, objects are <strong>transient</strong>. We provide an API <code class="code docutils literal notranslate"><span class="pre">client.persist()</span></code> that
can explicitly persist the metadata of the target object to etcd, ensuring its visibility
by clients connected to other instances in the cluster.</p>
</div>
</div>
<div class="section" id="builders-and-resolvers">
<span id="builder-resolver"></span><h3>Builders and resolvers<a class="headerlink" href="#builders-and-resolvers" title="Permalink to this heading">#</a></h3>
<p>Vineyard utilizes an extensible registry mechanism to enable users to easily integrate their
data structures into the system. This design, which includes builders, resolvers, and drivers,
allows users to create, resolve, and share their data structures across different systems and
paradigms. Notably, even the core data structures and drivers in Vineyard follow this design.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>What is the registry mechanism?</strong></p>
<p>The registry mechanism decouples methods from the definition of Vineyard data types. For
builders and resolvers, this means users can flexibly register different implementations
in various languages to build and resolve the same Vineyard data type. This enables data
sharing between different systems and paradigms and allows for native language optimizations.</p>
<p>For drivers, the registry mechanism permits users to flexibly plug in functionality methods
in different languages for Vineyard data types, providing the necessary capabilities for
data types during the data analysis process.</p>
<p>Moreover, the registered methods can be implemented and optimized according to specific
data analysis tasks, further enhancing efficiency.</p>
</div>
<p>Refer to <a class="reference internal" href="../../tutorials/extending/define-datatypes-python.html#define-python-types"><span class="std std-ref">Define Data Types in Python</span></a> and <a class="reference internal" href="../../tutorials/extending/define-datatypes-cpp.html#define-cpp-types"><span class="std std-ref">Defining Custom Data Types in C++</span></a> for examples of how builders
and resolvers are implemented in Python and C++, respectively.</p>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
<div class="related-pages">
  <a class="next-page" href="vcdl.html">
      <div class="page-info">
        <div class="context">
          <span>Next</span>
        </div>
        <div class="title">Code Generation for Boilerplate</div>
      </div>
      <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
    </a>
  <a class="prev-page" href="../key-concepts.html">
      <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
      <div class="page-info">
        <div class="context">
          <span>Previous</span>
        </div>
        
        <div class="title">Key Concepts</div>
        
      </div>
    </a>
</div>

<!-- index page doesn't have prev -->
  <hr/>

  <script src="https://giscus.app/client.js"
    data-repo="v6d-io/v6d"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzMDY2MzEyMTE="
    data-category="General"
    data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyNDA3MTg2"
    data-mapping="pathname"
    data-strict="1"
    data-reactions-enabled="0"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="light"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>

<div class="bottom-of-page">
  <div class="left-details">
    <div class="copyright">
        Copyright &#169; 2020-2023, The Vineyard Authors
    </div>
    Rendered with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a href="https://github.com/pradyunsg/furo">Furo</a>
    <p>The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation,
       please see our <a href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage page</a>.
    </p>
  </div>
  <div class="right-details">
    <div class="icons"><a class="muted-link" href="https://github.com//" aria-label="On GitHub">
        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
        </svg>
      </a>
    </div>
    <div>
      <a href="https://www.cncf.io/sandbox-projects/"><img src="https://v6d.io/_static/cncf-color.svg" alt="CLOUD NATIVE COMPUTING FOUNDATION" width="100%" style="max-width: 200px;"/></p>
    </div>
  </div>
</div>

      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal">Objects</a><ul>
<li><a class="reference internal" href="#object-metadata-payloads">Object = metadata + payloads</a></li>
<li><a class="reference internal" href="#separating-metadata-and-payload">Separating metadata and payload</a></li>
<li><a class="reference internal" href="#data-model">Data model</a><ul>
<li><a class="reference internal" href="#composable">Composable</a></li>
<li><a class="reference internal" href="#distributed-objects">Distributed objects</a></li>
<li><a class="reference internal" href="#transient-vs-persistent">Transient vs. Persistent</a></li>
<li><a class="reference internal" href="#builders-and-resolvers">Builders and resolvers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>